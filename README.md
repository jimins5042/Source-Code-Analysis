# 1. 개요
1978년에 개발된 초기 아케이드 슈팅 게임인 ‘Space Invaders‘의 소스코드를 분석한 후 개선 및 리펙토링하는 프로젝트이다.  
‘Space Invaders‘의 소스코드를 분석한 결과, 다음과 같은 사항을 개선하고 기능을 추가했다.

## 1.1. 구현사항
-	스코어 관리
-	5개 이상 Level 지원
-	메인 화면 최고 스코어 표시
-	게임 진행 사항을 알 수 있는 데이터를 화면에 표시
-	게임 진행 사항, 플레이어 데이터 등을 데이터베이스에 기록 및 조회
-	상점 기능 추가
-	서로 다른 능력치를 가지고 있는 캐릭터 종류 추가
-	1pc – 2인용 미니 게임 추가
-	로그인 기능을 사용하여 플레이어 개개인의 게임 기록 관리
-	도전과제 기능 추가
-	배경음악, 사격 효과음 추가
-	충돌 시 게임 종료되는 ‘운석’ 추가

## 2. 화면 구성
프로젝트 화면 구성의 경우 View와 실행 로직을 컴포넌트 레이아웃과 ActionListener를 적극 활용하여 분리했다. 
객체를 사용하여 View에 데이터를 전달하는 ‘MVC’ 패턴을 도입했다.  

ex) ‘도전과제’ 기능의 경우 
  - LoginService 클래스의 ChallengeListener메소드에서 버튼, 입력 창 컴포넌트를 사용하여 View를 구성
  - Challenge 클래스로 도전과제 달성 여부  검사 로직을 분리
  - ChallengeRepository 클래스와 CheckChallengeRepository 클래스는 캡슐화한 후 값을 전달해주는 용도로만 사용

그러나 다른 프레임워크나 툴 없이 순수 java를 사용하여 개발을 진행했기 때문에  
완벽한 MVC 패턴을 구현하는 데는 어려움이 있었다.

[![Video Label](http://img.youtube.com/vi/jygAvHTMsHE/0.jpg)](https://youtu.be/jygAvHTMsHE)
 
# 3. 구현 기능 소개

## 3.1. 필수구현 사항
3.1.1. 스코어 관리
-	더 많은 invader를 처치할 수록, 더 많은 스테이지를 클리어할 수록,  빠르게 게임을 클리어 할수록 높은 스코어 획득
-	스코어 계산 공식 : ((클리어한 스테이지 * invader킬 수 ) / 플레이 타임) + 남아있는 코인
-	
3.1.2 .  5개 이상 여러 Level을 지원
-	게임오버가 되지 않는 한 게임은 끝나지 않으며, 난이도가 계속 증가
-	스테이지 단계와 등장하는 invader의 수가 비례하여 증가
-	스테이지 단계와 invader의 하강속도가 비례하여 증가
-	스테이지 단계와 떨어지는 운석의 속도가 비례하여 증가

3.1.3. 메인 화면
-	"새 게임", "게임 이어가기", "2인 플레이", "캐릭터 선택", "상점", "로그인/마이페이지",  
  "게임 종료" 로 이루어진 7개의 버튼을 GridBagLayout을 사용하여 수직 정렬
-	로그인/마이페이지 버튼은 로그인 전에는 로그인 페이지를, 로그인 후에는 마이페이지 표시
-	최고점수는 ‘메인 화면’의 통일성을 위해 ‘마이페이지’에서 확인 가능
-	게임이 끝날 경우 플레이어의 게임기록과 플레이어의 최고기록을 표시하는 알림 창을 사용자에게 나타냄


## 3.2. 추가구현 사항

3.2.1. 로그인 기능
-	 로그인 기능 및 비밀번호 찾기 로직 구현
-	로그인 쿠키를 사용하여 상점, 게임 이어가기 등 권한이 필요한 특정 메뉴에 접근 제한
-	로그인 성공 후 로그인 화면을 ‘마이페이지’ 화면으로 변경
-	별도의 회원가입 없이 게임 플레이가 가능한 게스트 로그인 기능 구현 

3.2.2. 회원가입 기능
-	아이디나 비밀번호를 빈칸으로 입력하거나 사용중인 아이디로 회원가입 하는 것을 방지
-	가입된 플레이어 목록을 조회하는 회원 목록 기능 구현

3.2.3. 마이페이지 기능
-	특정 플레이어 게임기록 확인 기능 및 도전 과제 확인 기능 구현
-	게임 기록 확인 시 플레이어의 최고기록도 함께 표시
-	도전과제의 경우 도전과제 달성률 및 달성한 도전과제 목록 표시

3.2.4. 게임 플레이
-	'm' key 입력 시 메인 메뉴로 화면 이동
-	invader의 숫자은 스테이지 단계에 따라 비례하여 증가
-	invader 처치 시 일정 확률로 코인 획득
-	랜덤한 위치에 ‘운석’이 떨어지며 플레이어가 ‘운석’과 충돌한 경우 게임 종료
-	'save()'를 사용하여 스테이지 및 게임 종료 시 게임 플레이 기록을 저장
-	게임이 종료되면 구매한 능력치와 추가로 얻은 코인은 초기화 
-	invader 하강 속도 공식 : (기본 속도(10) + 현재 스테이지 레벨 *  5) * ‘적 하강 속도 감소’ 아이템의 수
-	사격 속도 공식 : 캐릭터 별 기본 사격 속도 * ‘사격속도 증가’ 아이템의 수
-	운석 하강 속도 공식 : 운석 기본 속도 + 2 * 현재 스테이지 레벨

3.2.5. 1PC – 2인 플레이
-	하나의 PC로 2명의 플레이어가 같이 플레이할 수 있도록 미니게임을 구현
-	사용자마다 캐릭터 설정이 가능하도록 구현
-	등장하는 invader를 더 적은 숫자의 총알로 더 많이 처치하는 플레이어가 승리

3.2.6. 상점
-	상점에서 ‘사격 속도 증가’, ‘적 하강 속도 감소’ 아이템 판매 및 구매 기능
-	상점 화면에 표시된 정보는 구매할 때마다 갱신하여 표시
-	코인이 부족하거나 능력치가 최대 레벨에 도달한 경우 팝업 창 표시
-	상점에서 구매한 능력치는 게임에서 적용되며, 게임이 종료되거나 로그아웃 할 경우 초기화 


3.2.7. 캐릭터 선택창
- 캐릭터는 ‘Basic’, ‘Tank’, ‘Fighter Plane’, ‘Rocket’ 총 네 가지
- 각 캐릭터 마다 고유의 사격 속도 및 사격 모션 보유 
  Ex) ‘Tank’의 경우 3발의 총알이 나란히 발사되며, ‘Fighter Plane’의 경우 캐릭터 좌우로 총알이 번갈아 가면서 발사
- Game 클래스에서 Switch문을 사용하여 선택된 캐릭터의 스킨 및 능력치에 맞게 변경

3.2.8. 도전과제
-	isSafity() 메소드를 통해 도전과제의 특정 조건이 충족되면 화면에 표시.
  Ex) 아이템을 구매하지 않고, 5스테이지 클리어.
-	매 스테이지 마다 도전과제 달성여부를 확인한 후, DB 저장.
-	‘마이페이지’에서 달성한 도전과제와 달성률 확인 가능.

3.2.9. 데이터베이스
-	MySQL의 JDBC 드라이버를 사용.
-	게임 플레이 기록 관리, 회원 관리, 도전과제 관리를 위한 3개의 table 생성 
(invader, memberlist, challenge)




# 4. 차별성

4.1. 1PC - 2인용 미니게임
하나의 PC에서 두 명이 플레이 할 수 있는 2인용 미니게임을 추가하였다.  
플레이 방식 및 게임 룰은 다음과 같다.

-	1P는 'A', 'S', 'D' 버튼을 사용하여 캐릭터를 조종하고, 2P는 방향키인 '←', '↓', '→' 를 사용하여 캐릭터 조종
-	invader을 처치할 때마다 플레이어에게 20포인트가 부여
-	총알을 발사할 때마다 플레이어의 10포인트가 감점
-	invader가 바닥에 닿거나 어느 한 플레이어가  invader를 전부 처치하는 경우, 두 플레이어의 포인트를 비교
-	더 높은 포인트를 모은 플레이어가 승리
  
4.2. 쿠키 기능
로그인한 플레이어의 정보를 유지하기 위해서는 특정 기능에 접근할 때 마다 플레이어의 이름 및 비밀번호를 체크하는 기능을 구현해야 했다.  
하지만 이 과정은 상당히 복잡하고 프로젝트를 테스트하기에 번거로웠다. 

따라서 로그인/회원가입 기능을 구현하고, 로그인한 플레이어의 정보를 유지하기 위해 쿠키를 도입했다.  
쿠키의 역할은 다음과 같다.

-	비로그인 사용자에 대해 '마이페이지', '상점', '게임 이어가기' 등 특정 기능 접근 제한
-	쿠키가 존재할 경우 로그인/회원가입 화면을 마이페이지 화면으로 전환
-	쿠키를 사용하여 플레이어의 게임 기록 자동 저장 및 조회 
-	로그인 없이 '새 게임'을 시작하려는 경우 로그인 화면으로 전환
  •	로그인에 성공하면 새 게임을 시작.
  •	로그인에 실패하면 메인 화면으로 전환.

4.3. 쿠키를 사용한 페이지 재사용
- ‘마이페이지’ 화면을 구현하기 위해 별도의 버튼을 추가하는 대신, if 문을 사용하여 ‘로그인’ 페이지를 재사용
- 로그인 쿠키가 존재하지 않을 경우, 로그인을 하기위한 텍스트 입력창과 버튼을 화면에 표시
- 로그인 쿠키가 존재할 경우, ‘플레이 기록을 확인’ 버튼과 ‘도전과제’ 버튼을 화면에 표시
- 이를 통해 중복 로그인을 방지했으며 별도의 페이지를 구현하기 위한 코드를 절약


# sql
~~~
create table invader
(
id         int auto_increment
primary key,
play_time  int         null,
stage      int         null,
kill_count int         null,
play_score int         null,
coin       int         null,
name       varchar(30) null,
password   varchar(30) null
);



create table memberlist
(
mId      int auto_increment
primary key,
name     varchar(30) null,
password varchar(30) null

);

create table challenge
(
cId      int auto_increment
primary key,
name     varchar(30) null,
remove   int         null,
time_atk int         null,
no_item  int         null
);
~~~
